<h3>Welcome</h3>

<p id="notice"><%= notice %></p>

<h1>Listing Ideas</h1>

sort by: <%= link_to 'Ascending', visitorascending_path %> - 
<%= link_to 'Descending', visitordescending_path %> - 
<%= link_to 'Newest to Oldest', visitornewest_path %> -
<%= link_to 'Oldest to Newest', visitoroldest_path %>


<table>
  <thead>
    <tr>
      <th> Title </th>
      <th>Idea description</th>
      <th>Skill description</th>
      <th>User</th>
      <th>Platform</th>
      <% if logged_in? %>
      <th> Role Status</th>
      <% end %>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @ideas.each do |idea| %>
      <tr>
        <td><%= idea.title %></td>
        <td><%= idea.idea_description %></td>
        <td><%= idea.skill_description %></td>
        <td><%= idea.user.name %></td>
        <td><%= idea.platform.name %></td>

<% if logged_in? %>

<td><% idea.roles.all.each do|role| %> 
          <ul>
            <li>
              <%= role.name%> - 
              <% if idea.idears.find_by(role_id:role.id).filled? %>
              <%= User.find_by(id:(idea.idears.find_by(role_id:role.id).user_id)).name %>
              <% else %>
              <%= link_to 'Register', idear_path(idea.idears.find_by(role_id: role.id)) %> 
            <% end %>
            </li>
           </ul>
    <% end %>

</td>
  <% end %>

        <td><%= link_to 'Show', idea %></td>

      </tr>
    <% end %>
  </tbody>
</table>